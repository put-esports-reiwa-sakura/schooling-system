<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="robots" content="noindex, nofollow">
		<meta name="format-detection" content="telephone=no">
		<title>令和さくら高等学院-各学年の必要な荷物</title>
		<!-- 上から Roboto , Zen Maru Gothic , Noto Sans Japanese , english- Poppins -->
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap">
		<link rel="stylesheet" type="text/css" href="mainstyle.css">
		<style>
		.osirase-nimotu .osirase-nimotu-custom {
			text-align: center;
		}
		
		.osirase-nimotu .osirase-nimotu-hontai ul {
			max-width: 600px;
			margin: 10px auto;
			background-color: #444;
			border-radius: 8px;
			box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
			padding: 20px;
		}
		.osirase-nimotu .osirase-nimotu-hontai ul .osirase-nimotu-nakami1 {color:burlywood}
		.osirase-nimotu .osirase-nimotu-hontai ul .osirase-nimotu-nakami2 {color:aquamarine}
		.osirase-nimotu li{
			display: table-cell;
			list-style: none;
			margin-left: 0px;
		}
		.osirase-nimotu h1{
			text-align: center;
		}
		.osirase-nimotu select {
		background-color: #f1f164d4;
		border: 1px solid #ccc;
		border-radius: 5px;
		padding: 1px 2px;
		font-size: 28px;
		width: 175px;
		height: 60px;
		}
		.osirase-nimotu .osirase-nimotu-hontai .osirase-nimotu-stack {
			font-family: 'Roboto', sans-serif;
			position: sticky;
			top: 0;
			left: 0%;
			z-index: 999;
			background-color: rgb(51 51 51 / 50%);
		}
		.osirase-nimotu .osirase-nimotu-custom label {font-size: 25px;}
		.osirase-nimotu select:hover {font-weight:bold;}
		
		.osirase-nimotu select:focus { /* 展開 */
		  outline: none;
		  border: 1px solid #4285f4; /* 選択時のハイライトカラー */
		  box-shadow: 0 0 5px #4285f4; /* 選択時のボックスシャドウ */
		}
		.osirase-nimotu #osirase-nimotu-loading {
			text-align: center;
			font-size: 2em;
		}
		</style>
		<script>
			var osiraseNimotu_url = "https://put-esports-reiwa-sakura.github.io/schooling-system/spreadsheetdata.json";
			var osiraseNimotu_selectedYear = ""; // 初期選択: なし

			// ページ読み込み時に一時保存取得
			window.onload = function() {
			  var savedYear = localStorage.getItem("osirase-nimotu-selectedYear");
			  if (savedYear) {
				document.getElementById("osirase-nimotu-yearSelect").value = savedYear;
				osiraseNimotu_selectedYear = savedYear;
			  }
			  osiraseNimotu_updateData();
			};

			// 表示したいキーワード
			function osiraseNimotu_updateData() {
			  var resultDiv = document.getElementById("osirase-nimotu-result");
			  var loadingDiv = document.getElementById("osirase-nimotu-loading");
			  var yearSelect = document.getElementById("osirase-nimotu-yearSelect");
			  var resultHTML = ""; // データを格納する変数
			  var title = ""; // タイトル

			  // ドロップダウンリストの選択値を取得
			  osiraseNimotu_selectedYear = yearSelect.value;

			  // 選択状態を一時保存
			  localStorage.setItem("osirase-nimotu-selectedYear", osiraseNimotu_selectedYear);

			  // 非表示にする
			  resultDiv.style.display = "none";

			  if (osiraseNimotu_selectedYear === "") {
				resultDiv.innerHTML = "学年を選択して、右側の[変更]を押してください。"; // 学年が選択されていない場合、データをクリア
				loadingDiv.innerHTML = "学年を選択して、右側の[変更]を押してください。"; // ローディングメッセージを表示
				loadingDiv.style.display = "block"; // ローディングメッセージを表示
				title = "持ち物";
			  } else {
				var searchKeyword = osiraseNimotu_selectedYear; // 選択した年度に基づいて検索
				title = osiraseNimotu_selectedYear + "</span>　それぞれの<br>教科で必要な持ち物";

				// エラーメッセージをクリア
				loadingDiv.innerHTML = "<h1>読み込み中...</h1>"; // 読み込み中メッセージを表示
				loadingDiv.style.display = "block"; // ローディングメッセージを表示

				// タイムアウト設定（例: 3秒）
				var timeout = setTimeout(function() {
				  // タイムアウトメッセージを表示
				  loadingDiv.innerHTML = "インターネットの接続が悪いようです。";
				}, 3000);

				fetch(osiraseNimotu_url)
				  .then(response => {
					if (!response.ok) {
					  // サーバーエラー
					  throw new Error("サーバーエラーが発生しました。");
					}
					return response.json();
				  })
				  .then(data => {
					// タイムアウトクリア
					clearTimeout(timeout);

					data.forEach(function(item) {
					  if (item.F === searchKeyword) {
						resultHTML += `<li class="osirase-nimotu-nakami1">${item.B}の${item.C}、${item.H}</li><li class="osirase-nimotu-nakami2">${item.P}</li><br>`;
					  }
					});

					// 読み込み中メッセージを非表示にして、結果を表示
					loadingDiv.style.display = "none";
					resultDiv.style.display = "block";
					resultDiv.innerHTML = `<div class="osirase-nimotu-stack"><h1><span style="color: #ea4335;">${title}</h1></div><ul>${resultHTML}</ul>`;
				  })
				  .catch(error => {
					// タイムアウトクリア
					clearTimeout(timeout);

					// エラーメッセージを表示
					loadingDiv.innerHTML = error.message;

					// エラーメッセージを表示
					if (error.message === "サーバーエラーが発生しました。") {
					  loadingDiv.innerHTML = "サーバーエラーが発生しました。";
					} else if (error.message === "インターネットの接続が悪いようです。") {
					  // ネットワーク接続の問題
					  loadingDiv.innerHTML = "インターネットの接続が悪いようです。インターネットの接続状況を確認して変更ボタンを押してみてください。";
					} else if (error.message === "ご迷惑をおかけします。クロスドメインエラーのようです。サーバー側の一時的な問題なのでお手数おかけしますが後でもう一度試してみてください。") {
					  // クロスドメイン制約
					  loadingDiv.innerHTML = "ご迷惑をおかけします。クロスドメイン制約によりデータを取得できません。サーバー側の一時的な問題なのでお手数おかけしますが後でもう一度試してみてください。";
					} else {
					  // その他のエラー
					  loadingDiv.innerHTML = "エラーが発生しました。インターネットの接続状態を確認して変更ボタンを押してみてください。";
					}
				  });
			  }
			}
		</script>
	</head>
	<body>
		<!-- 著作権表示 -->
		<div class="menu-copyright">&copy; 2023 reiwa-sakura, one person Aoyama programming team.</div>
		<div class="osirase-nimotu">
			<div class="osirase-nimotu-custom page-main">
			<h1>各教科の必要な荷物</h1>
			<a onclick="location.href = 'schooling-nituite.html#page1'"><button id="back-to-menu-2">戻る</button></a>
			<label for="osirase-nimotu-yearSelect">学年を選択:</label>
				<select id="osirase-nimotu-yearSelect">
						<option value="">学年の選択</option>
						<option value="1年生">1年生</option>
						<option value="2年生">2年生</option>
						<option value="3年生">3年生</option>
						<option value="対象のみ">一部対象者のみ</option>
				</select>
				<button id="osirase-nimotu-changeButton" onclick="osiraseNimotu_updateData()">変更</button>
			</div>
		<div id="osirase-nimotu-loading" style="display: none;"></div>
		<div id="osirase-nimotu-result" class="osirase-nimotu-hontai"></div>
		</div>
	</body>
</html>